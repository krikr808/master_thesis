% lithmaketitle.sty is a LaTeX package to create a title page following the LiTH specifications.
% This package is derived from the popular non-standard package titlepic
% By Kristofer Krus <krikr808@student.liu.se>. Free software, no warranty of any kind.
% 
% V. 0.1
% -----------------------------------------------------------------------------

% No idea whether it works on older LaTeXes.
\NeedsTeXFormat{LaTeX2e}

% Package identification and version number.
\ProvidesPackage{lithmaketitle}[2012/05/28 0.1 Package create a title page following the LiTH specifications]

% Package used
\RequirePackage{fancyhdr} % Use the fancyhdr package to create headers and footers
\RequirePackage{color} % Use the color package to mark unentered fields

% Declare the options.
\DeclareOption{tt}{\gdef\@tptopspace{}\gdef\@tpsepspace{\vskip 3em}}
\DeclareOption{tc}{\gdef\@tptopspace{}\gdef\@tpsepspace{\vfil}}
\DeclareOption{cc}{\gdef\@tptopspace{\null\vfil}\gdef\@tpsepspace{\vskip 3em}}
\ExecuteOptions{cc}
\ProcessOptions

% Additional commands for defining parameters used by this package.
% Very similar to the definition of \title, etc.
% \lithlogo
\def\lithlogo#1{\gdef\@lithlogo{#1}}
\def\@lithlogo{\textcolor{red}{\framebox[0.6\textwidth]{\raisebox{-0.2\textwidth}{\textit{Logo}}\raisebox{-0.4\textwidth}{}}}}
% \lithwork
\def\lithwork#1{\gdef\@lithwork{#1}}
\def\@lithwork{Master thesis work} % default value
% \lithcompany
\def\lithcompany#1{\gdef\@lithcompany{#1}}
\def\@lithcompany{\textcolor{red}{\textit{Company}}} % default value
% \lithuniversity
\def\lithuniversity#1{\gdef\@lithuniversity{#1}}
\def\@lithuniversity{Link\"{o}pings universitet} % default value
% \lithdepartment
\def\lithdepartment#1{\gdef\@lithdepartment{#1}}
\def\@lithdepartment{Department of Physics, Chemistry and Biology} % default value
% \lithpostaddress
\def\lithpostaladdress#1{\gdef\@lithpostaladdress{#1}}
\def\@lithpostaladdress{581 83 Link\"{o}ping, Sweden} % default value
% \lithsupervisor
\def\lithsupervisor#1{\gdef\@lithsupervisor{#1}}
\def\@lithsupervisor{\textcolor{red}{\textit{Supervisor}}} % default value
% \lithsupervisors
\def\lithsupervisors#1{\gdef\@lithsupervisors{#1}}
%\def\@lithsupervisors{\textit{Supervisors}} % default value
% \lithexaminor
\def\lithexaminer#1{\gdef\@lithexaminer{#1}}
\def\@lithexaminer{\textcolor{red}{\textit{Examiner}}} % default value
\def\lithx#1{\gdef\@lithx{#1}}
\def\@lithx{\textcolor{red}{\textit{x}}} % default value
\def\lithyy#1{\gdef\@lithyy{#1}}
%\def\@lithyy{\shortyear} % default value
\def\@lithyy{\textcolor{red}{\textit{yy}}} % default value
\def\lithxxxx#1{\gdef\@lithxxxx{#1}}
\def\@lithxxxx{\textcolor{red}{\textit{xxxx}}} % default value

% Define default parameters
\def\@author{\textcolor{red}{\textit{Author}}} % default value
\def\@title{\textcolor{red}{\textit{Title}}} % default value
\def\@date{\textcolor{red}{\textit{Date}}} % default value
\def\@thanks{} % default value

% Additional miscellaneous commands
\def\shortyear{\expandafter\@YYYYTOYY\the\year}
\def\@YYYYTOYY#1#2#3#4{#3#4}

% If a title page was requested from the document class (article/report/book),
% define \lithmaketitle.
\if@titlepage
\newcommand\lithmaketitle{
    \begin{titlepage}%
        \let\footnotesize\small
        \let\footnoterule\relax
        \let \footnote \thanks
        \renewcommand{\headrulewidth}{0pt} % Remove horozontal ruler under header
        \fancyhfoffset[]{\dimexpr\marginparsep+\marginparwidth\relax} % Make header and footer wider. \RequirePackage{calc} can be used instead of using \dimexpr and \relax.
        \begin{center}% Make the font on the title page get a bold face and center the content
            \bf \large
            
            % Page 1
            \thispagestyle{fancy} %TODO: Check why just pagestyle doesn't work
            \chead{\bf \large \@lithdepartment}
            \cfoot{\bf \normalsize \@lithdepartment\\ \@lithuniversity\\ \@lithpostaladdress}
            \@tptopspace%
            \@lithwork
            \vskip 1em%
            {\LARGE \@title \par}%
            \vskip 3em%
            \lineskip .75em%
            \begin{tabular}[t]{c}%
                \@author \\
                \@lithwork\ carried out at \@lithcompany \\
                \@date
            \end{tabular}\par%
            \vskip 1.5em%
            LITH-IFM-\@lithx-EX-{}-\@lithyy/\@lithxxxx---SE
            \@tpsepspace%
            {\centering\@lithlogo\par}
            \clearpage
            
            % Page 2
            \thispagestyle{fancy}
            \cfoot{}
            \@tptopspace%
            {\LARGE \@title \par}%
            \vskip 3em%
            \lineskip .75em%
            \begin{tabular}[t]{c}%
                \@author \\ \\
                \@lithwork\ carried out at \@lithcompany \\ \\
                \@date
            \end{tabular}\par%
            \vskip 1.5em%
            \ifx \@lithsupervisors \undefined
                Supervisor: \\
                \@lithsupervisor
            \else
                Supervisors: \\
                \@lithsupervisors
            \fi
            \vskip 1em%
            Examiner: \\
            \@lithexaminer
            \@tpsepspace%
            {\centering\@lithlogo\par}
            \vfil
        \end{center}\par
        \@thanks
    \end{titlepage}%
    \setcounter{footnote}{0}%
    \global\let\thanks\relax
    \global\let\maketitle\relax
    \global\let\@thanks\@empty
    \global\let\@author\@empty
    \global\let\@date\@empty
    \global\let\@title\@empty
    \global\let\@lithlogo\@empty
    \global\let\title\relax
    \global\let\author\relax
    \global\let\date\relax
    \global\let\and\relax
    \global\let\titlepic\relax
}
\fi
